import*as e from"three";import{GLTFLoader as t}from"../jsm/GLTFLoader.js";import{CharacterControls as o}from"./charaterControls.js";import{OrbitControls as a}from"../jsm/OrbitControls.js";import{CSS2DRenderer as n,CSS2DObject as i}from"../jsm/CSS2DRenderer.js";let scene,camera,renderer,model,characterControls,orbitControls,keysPressed,labelRenderer,mixer,mixerseta,mixerseta1,mixerseta2,mixer3,mixerCozinheiro,mixergalinha,mixerPassaro,mixerVaca,rainGeo,rain,rainDrop,cloudGeo,rainCount=3e3,clouds=[],leavesMaterial,andando=!0,andandoPassaro=!0,girando=!0,flutuando=!0,galinha,passaro,floorParedefrontal,floorParedefrontal1,floorParedefrontal2,floorParedefrontal3,mudardisplayBaixo,mudardisplayAlto,aviao,decolando=!1,somAviao;function init(){scene=new e.Scene,(camera=new e.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,200)).position.z=1,camera.rotation.x=1.16,camera.rotation.z=.27,renderer=new e.WebGLRenderer({antialias:!0}),scene.fog=new e.FogExp2(8900331,.002),renderer.setClearColor(scene.fog.color),renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMap.enabled=!0,document.body.appendChild(renderer.domElement),(labelRenderer=new n).setSize(window.innerWidth,window.innerHeight),labelRenderer.domElement.style.position="absolute",labelRenderer.domElement.style.top="0px",labelRenderer.domElement.style.pointerEvents="none",document.body.appendChild(labelRenderer.domElement);let s=new e.TextureLoader,r=s.load("./textures/cerca.png");r.wrapS=e.RepeatWrapping,r.wrapT=e.RepeatWrapping,r.repeat.set(5,1);let l=new e.MeshPhongMaterial({map:r,transparent:!0,side:e.DoubleSide});function d(t,o,a,n,i,s){let r=new e.TextureLoader,l=r.load("./textures/estrada.png"),d=new e.PlaneGeometry(t,o),c=new e.MeshPhongMaterial({map:l,transparent:!0}),$=new e.Mesh(d,c);$.castShadow=!0,$.receiveShadow=!0,$.rotation.x=-Math.PI/2,$.rotation.z=s,$.position.set(a,n,i),scene.add($)}(function t(o,a,n,i,s,r){let d=new e.PlaneGeometry(20,1);(floorParedefrontal=new e.Mesh(d,l)).position.set(0,.5,-14.9),floorParedefrontal.rotation.y=0,scene.add(floorParedefrontal)})(20,1,0,.5,-14.9,0),function t(o,a,n,i,s,r){let d=new e.PlaneGeometry(20,1);(floorParedefrontal1=new e.Mesh(d,l)).position.set(10,.5,-5),floorParedefrontal1.rotation.y=r,scene.add(floorParedefrontal1)}(20,1,10,.5,-5,-Math.PI/2),function t(o,a,n,i,s,r){let d=new e.PlaneGeometry(20,1);(floorParedefrontal2=new e.Mesh(d,l)).position.set(-10,.5,-5),floorParedefrontal2.rotation.y=r,scene.add(floorParedefrontal2)}(20,1,-10,.5,-5,+Math.PI/2),function t(o,a,n,i,s,r){let d=new e.PlaneGeometry(20,1);(floorParedefrontal3=new e.Mesh(d,l)).position.set(0,.5,4.91),floorParedefrontal3.rotation.y=r,scene.add(floorParedefrontal3)}(20,1,0,.5,4.91,Math.PI),function t(){let o=new e.TextureLoader,a=o.load("./textures/MuchaTseBle.jpg"),n=new e.PlaneGeometry(30,30),i=new e.MeshPhongMaterial({map:a}),s=new e.Mesh(n,i);s.rotation.x=-Math.PI/2,s.position.set(0,0,-5),scene.add(s)}(),d(5,18,-8,.001,-6,0),d(5,16.6,1.7,.002,-8,1.6),d(5,11.5,8.5,.004,-.9,0),d(5,5.5,6.7,.004,-12.2,0),(orbitControls=new a(camera,renderer.domElement)).enableDamping=!0,orbitControls.minDistance=4,orbitControls.maxDistance=4,orbitControls.enablePan=!1,orbitControls.maxPolarAngle=Math.PI/2- -.1,orbitControls.minPolarAngle=Math.PI/2-1,orbitControls.enableZoom=!1,orbitControls.update();let c=new e.AudioListener;scene.add(c);let $=new e.Audio(c),m=new e.AudioLoader;m.load("../sound/trilha.mp3",e=>{$.setBuffer(e),$.setLoop(!0),$.setVolume(.5)});let p=new e.Audio(c),_=new e.AudioLoader;_.load("../sound/passaro.mp3",e=>{p.setBuffer(e),p.setLoop(!0),p.setVolume(.2),p.play()}),somAviao=new e.PositionalAudio(c);let w=new e.AudioLoader;w.load("../sound/aviao.mp3",e=>{somAviao.setBuffer(e),somAviao.setLoop(!1),somAviao.setVolume(.3),somAviao.setRefDistance(1)});let f=new e.PositionalAudio(c),h=new e.AudioLoader;h.load("../sound/click.mp3",e=>{f.setBuffer(e),f.setLoop(!1),f.setVolume(.5)});let u=new e.PositionalAudio(c),y=new e.AudioLoader;y.load("../sound/click_dYtiT6GS.mp3",e=>{u.setBuffer(e),u.setLoop(!1),u.setVolume(.5)});let b=document.getElementById("paraTrilha"),v=document.getElementById("ativarTrilha");b.addEventListener("click",()=>{$.stop(),b.style.display="none",v.style.display="block"}),v.addEventListener("click",()=>{$.play(),b.style.display="block",v.style.display="none"}),document.querySelector(".arrumarConfig").addEventListener("click",()=>{u.play()});let x=document.createElement("button");x.textContent="Noite",x.setAttribute("id","noite");let g=document.createElement("button");g.textContent="Dia",g.setAttribute("id","dia"),g.style.display="none";let P=document.createElement("div");P.setAttribute("id","home"),P.appendChild(x),P.appendChild(g);let E=new i(P);scene.add(E),E.position.set(-7.5,1.5,-2);var A=document.createElement("div");A.setAttribute("class","balao");var L=document.createElement("p");L.setAttribute("class","mensagem"),L.textContent="Bem vindo, fique a vontade para escolher seu lanche!",A.appendChild(L);let C=new i(A);scene.add(C),C.position.set(9,2,-3);var j=document.querySelector(".pratosProntos"),M=document.querySelector(".legumes"),S=document.querySelector(".bebidas"),k=document.querySelector("#fechar1"),O=document.querySelector("#fechar2"),B=document.querySelector("#fechar3");k.addEventListener("click",()=>{j.classList.remove("ativo"),k.style.display="none",f.play()}),O.addEventListener("click",()=>{S.classList.remove("ativo"),O.style.display="none",f.play()}),B.addEventListener("click",()=>{M.classList.remove("ativo"),B.style.display="none",f.play()});var D=document.createElement("button");D.setAttribute("class","btnAvi\xe3o"),D.textContent="Decolar";let F=new i(D);function z(){scene.remove(aviao)}scene.add(F),F.position.set(15,3.5,-18),D.addEventListener("click",()=>{decolando=!0,somAviao.play(),u.play(),document.querySelector(".btnAvi\xe3o").classList.add("ativo"),setTimeout(z,1e4)});let I=new e.CircleGeometry(.4,32),G=new e.MeshPhongMaterial({color:65280,transparent:!0}),q=new e.Mesh(I,G),W=new e.Mesh(I,G),V=new e.Mesh(I,G);q.rotation.x=-Math.PI/2,q.position.set(8,.01,-4.5),W.rotation.x=-Math.PI/2,W.position.set(7,.01,-12),V.rotation.x=-Math.PI/2,V.position.set(-7.5,.01,-13),scene.add(q),scene.add(W),scene.add(V);let R=document.createElement("button");R.textContent="Entrar",R.setAttribute("class","btnEntrar1");let T=new i(R);scene.add(T),T.position.set(8,1.5,-4.5);let H=document.createElement("button");H.textContent="Entrar",H.setAttribute("class","btnEntrar2");let U=new i(H);scene.add(U),U.position.set(7,1.5,-12);let N=document.createElement("button");N.textContent="Entrar",N.setAttribute("class","btnEntrar3");let K=new i(N);scene.add(K),K.position.set(-7.5,1.5,-13),R.addEventListener("click",()=>{j.classList.add("ativo"),k.style.display="block",f.play()}),H.addEventListener("click",()=>{S.classList.add("ativo"),O.style.display="block",f.play()}),N.addEventListener("click",()=>{M.classList.add("ativo"),B.style.display="block",f.play()});var Y=new e.Vector3;let Z=new t().setPath("./models/");Z.load("personagem.glb",function(t){(model=t.scene).scale.set(.25,.25,.25),model.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),scene.add(model);let a=t.animations,n=new e.AnimationMixer(model),i=new Map;a.filter(e=>"Tpose"!=e.name).forEach(e=>{i.set(e.name,n.clipAction(e))}),characterControls=new o(model,n,i,orbitControls,camera,"Idle"),!function t(){let o=!1,a=new e.Box3().setFromObject(characterControls.model),n=[new e.Box3().setFromObject(eo),new e.Box3().setFromObject(ea),new e.Box3().setFromObject(es),new e.Box3().setFromObject(er),new e.Box3().setFromObject(Q),new e.Box3().setFromObject(el),new e.Box3().setFromObject(ei),new e.Box3().setFromObject(en),new e.Box3().setFromObject(ed),new e.Box3().setFromObject(J),new e.Box3().setFromObject(floorParedefrontal),new e.Box3().setFromObject(floorParedefrontal1),new e.Box3().setFromObject(floorParedefrontal2),new e.Box3().setFromObject(floorParedefrontal3),];var i=new e.Box3().setFromObject(ea),s=new e.Box3().setFromObject(q),r=new e.Box3().setFromObject(W),l=new e.Box3().setFromObject(V);n.forEach(e=>{a.intersectsBox(e)&&(o=!0),a.intersectsBox(i)&&(A.style.display="block"),a.intersectsBox(s)?document.querySelector(".btnEntrar1").classList.add("ativo"):document.querySelector(".btnEntrar1").classList.remove("ativo"),a.intersectsBox(l)?document.querySelector(".btnEntrar3").classList.add("ativo"):document.querySelector(".btnEntrar3").classList.remove("ativo"),a.intersectsBox(r)?document.querySelector(".btnEntrar2").classList.add("ativo"):document.querySelector(".btnEntrar2").classList.remove("ativo")}),o?characterControls.model.position.copy(Y):Y.copy(characterControls.model.position),requestAnimationFrame(t)}()}),passaro=new e.Object3D,Z.load("birds.glb",function(t){passaro.add(t.scene),passaro.scale.set(1,1,1),passaro.rotation.y=-1.5,passaro.position.set(-20,12,-30),mixerPassaro=new e.AnimationMixer(passaro),t.animations.forEach(e=>{mixerPassaro.clipAction(e).play(),mixerPassaro.clipAction(e).clampWhenFinished=!0}),scene.add(passaro)});let J=new e.Object3D;Z.load("juice_shop.glb",function(e){J.add(e.scene),J.scale.set(30,30,30),J.rotation.y=-1.5,J.position.set(7,1,-14),J.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),scene.add(J)});let Q=new e.Object3D;Z.load("correio.glb",function(e){Q.add(e.scene),Q.scale.set(1.3,1.3,1.3),Q.rotation.y=0,Q.position.set(-7.5,0,-14),scene.add(Q)});let X=new e.Object3D;Z.load("free_tree_1.glb",function(e){X.add(e.scene),X.scale.set(.01,.01,.01),X.rotation.y=0,X.position.set(-9,0,-14),scene.add(X)});let ee=new e.Object3D;Z.load("free_tree_1.glb",function(e){ee.add(e.scene),ee.scale.set(.01,.01,.01),ee.rotation.y=0,ee.position.set(2,0,-5),scene.add(ee)}),aviao=new e.Object3D,Z.load("low_poly_plane.glb",function(e){aviao.add(e.scene),aviao.scale.set(1,1,1),aviao.rotation.y=-1.5,aviao.position.set(15,1.5,-18),scene.add(aviao)});let et=new e.Object3D;Z.load("cow.glb",function(t){et.add(t.scene),et.scale.set(.25,.25,.25),et.rotation.y=1,et.position.set(-3,0,-14),scene.add(et),mixerVaca=new e.AnimationMixer(et),t.animations.forEach(e=>{mixerVaca.clipAction(e).play(),mixerVaca.clipAction(e).clampWhenFinished=!0})});let eo=new e.Object3D;Z.load("barbecue_grill.glb",function(e){eo.add(e.scene),eo.scale.set(2,2,2),eo.rotation.y=3,eo.position.set(9,0,-4.5),eo.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),scene.add(eo)});let ea=new e.Object3D;Z.load("tonko.glb",function(t){ea.add(t.scene),ea.scale.set(.0012,.0012,.0012),ea.rotation.y=-1,ea.position.set(9,0,-3),ea.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),mixerCozinheiro=new e.AnimationMixer(ea),t.animations.forEach(e=>{mixerCozinheiro.clipAction(e).play(),mixerCozinheiro.clipAction(e).clampWhenFinished=!0}),scene.add(ea)}),galinha=new e.Object3D,Z.load("chicken_walkcycle.glb",function(t){galinha.add(t.scene),galinha.scale.set(4e-4,4e-4,4e-4),galinha.rotation.y=1.5,galinha.position.set(-9,0,-8),galinha.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),mixergalinha=new e.AnimationMixer(galinha),t.animations.forEach(e=>{mixergalinha.clipAction(e).play(),mixergalinha.clipAction(e).clampWhenFinished=!0}),scene.add(galinha)});let en=new e.Object3D;Z.load("poste.glb",function(e){en.add(e.scene),en.scale.set(.3,.3,.3),en.position.set(9.5,0,-14),scene.add(en)});let ei=new e.Object3D;Z.load("firewood02.glb",function(e){ei.add(e.scene),ei.scale.set(3,3,3),ei.position.set(0,0,-14.2),ei.rotation.y=1.5,scene.add(ei)});let es=new e.Object3D;Z.load("banco_de_madeira.glb",function(e){es.add(e.scene),es.scale.set(.25,.25,.25),es.position.set(9.5,0,-8),es.rotation.y=Math.PI,scene.add(es)});let er=new e.Object3D;Z.load("low-poly_tractor.glb",function(e){er.add(e.scene),er.scale.set(1,1,1),er.position.set(8,0,3.5),er.rotation.y=-1.5,scene.add(er)});let el=new e.Object3D;Z.load("well.glb",function(e){el.add(e.scene),el.scale.set(1,1,1),el.position.set(-2,0,-5),scene.add(el)});let ed=new e.Object3D;Z.load("druids_house_and_shop.glb",function(e){ed.add(e.scene),ed.scale.set(2.8,2.8,2.8),ed.position.set(-7.5,0,1.4),ed.rotation.y=1.6,scene.add(ed)});let ec=new e.Object3D;Z.load("playground.glb",function(e){ec.add(e.scene),ec.scale.set(.3,.3,.3),ec.position.set(-0,.7,4.3),ec.rotation.y=3.1,scene.add(ec)});let e$=new e.Object3D;Z.load("sun.glb",function(e){e$.add(e.scene),e$.scale.set(.05,.05,.05),e$.position.set(50,30,-50),e$.rotation.y=1.6,scene.add(e$)});let em=new e.Object3D;Z.load("lua.glb",function(e){em.add(e.scene),em.scale.set(5,5,5),em.position.set(50,30,-100),em.rotation.y=1.6});let ep=new e.Object3D;Z.load("directional_arrow_1.glb",function(t){ep.add(t.scene),ep.scale.set(.03,.03,.03),ep.position.set(8,.5,-4.5),ep.rotation.y=2,mixerseta=new e.AnimationMixer(ep),t.animations.forEach(e=>{mixerseta.clipAction(e).play(),mixerseta.clipAction(e).clampWhenFinished=!0}),scene.add(ep)});let e_=new e.Object3D;Z.load("directional_arrow_1.glb",function(t){e_.add(t.scene),e_.scale.set(.03,.03,.03),e_.position.set(7,.5,-12),e_.rotation.y=2.5,mixerseta1=new e.AnimationMixer(e_),t.animations.forEach(e=>{mixerseta1.clipAction(e).play(),mixerseta1.clipAction(e).clampWhenFinished=!0}),scene.add(e_)});let ew=new e.Object3D;Z.load("directional_arrow_1.glb",function(t){ew.add(t.scene),ew.scale.set(.03,.03,.03),ew.position.set(-7.5,.5,-13),ew.rotation.y=3.5,mixerseta2=new e.AnimationMixer(ew),t.animations.forEach(e=>{mixerseta2.clipAction(e).play(),mixerseta2.clipAction(e).clampWhenFinished=!0}),scene.add(ew)});var ef=new e.AmbientLight(16777215,.7);let eh=new e.DirectionalLight(16580566,1);eh.position.set(50,30,-50),eh.castShadow=!0,eh.shadow.camera.top=50,eh.shadow.camera.bottom=-50,eh.shadow.camera.left=-50,eh.shadow.camera.right=50,eh.shadow.camera.near=.1,eh.shadow.camera.far=200,eh.shadow.mapSize.width=4096,eh.shadow.mapSize.height=4096,scene.add(eh),scene.add(ef);var eu=new e.AmbientLight(9605778,1);let ey=new e.DirectionalLight(11531263,1);ey.position.set(50,30,-100),ey.castShadow=!0,ey.shadow.camera.top=50,ey.shadow.camera.bottom=-50,ey.shadow.camera.left=-50,ey.shadow.camera.right=50,ey.shadow.camera.near=.1,ey.shadow.camera.far=200,ey.shadow.mapSize.width=4096,ey.shadow.mapSize.height=4096;let eb=new e.PointLight(16579698,10,10,1);eb.position.set(9.5,2,-13);let ev=new e.PointLight(16719360,1,1,4);ev.position.set(9,1,-4.5);let ex=new e.PointLight(16777215,10,40,0);ex.position.set(50,30,-80);let e1=new e.PointLight(65280,10,1,0);e1.position.set(8,.01,-4.5),scene.add(e1);let e3=new e.PointLight(65280,10,1,0);e3.position.set(7,.01,-12),scene.add(e3);let eg=new e.PointLight(65280,10,1,0);eg.position.set(-7.5,.01,-13),scene.add(eg);let e0=document.getElementById("screen");var eP=!1;mudardisplayBaixo=document.querySelector(".display"),mudardisplayAlto=document.getElementById("adicionar"),mudardisplayBaixo.addEventListener("click",()=>{renderer.shadowMap.enabled=!1,eh.castShadow=!1,ey.castShadow=!1,scene.remove(ex),scene.remove(ev),scene.remove(eb),scene.remove(passaro),scene.remove(e2),scene.remove(eh),scene.remove(ey),scene.remove(galinha),eP=!0,e0.style.display="block",e0.addEventListener("animationend",function(){this.style.display="none"})}),mudardisplayAlto.addEventListener("click",()=>{renderer.shadowMap.enabled=!0,eh.castShadow=!0,ey.castShadow=!0,scene.add(passaro),scene.add(e2),scene.add(eh),scene.add(galinha),eP=!1,e0.style.display="block",e0.addEventListener("animationend",function(){this.style.display="none"})});let eE=[],eA=[];rainGeo=new e.BufferGeometry;for(let eL=0;eL<rainCount;eL++)rainDrop=new e.Vector3(400*Math.random()-200,500*Math.random()-250,400*Math.random()-200),eE.push(400*Math.random()-200),eE.push(500*Math.random()-250),eE.push(400*Math.random()-200),eA.push(30);rainGeo.setAttribute("position",new e.BufferAttribute(new Float32Array(eE),4)),rainGeo.setAttribute("size",new e.BufferAttribute(new Float32Array(eA),1));let eC=new e.PointsMaterial({color:14417149,size:.2,transparent:!0});rain=new e.Points(rainGeo,eC),x.addEventListener("click",function(){e0.addEventListener("animationend",function(){this.style.display="none"}),scene.fog=new e.FogExp2(1118495,.002),renderer.setClearColor(scene.fog.color),scene.remove(eh),scene.remove(ef),scene.remove(passaro),scene.remove(e$),scene.add(em),!0===eP?(scene.remove(ey),scene.remove(ex),scene.remove(ev),scene.remove(eb)):(scene.add(ey),scene.add(eb),scene.add(ev),scene.add(ex)),scene.add(eu),scene.add(rain),e0.style.display="block",x.style.display="none",g.style.display="block",p.stop(),u.play()}),g.addEventListener("click",function(){scene.fog=new e.FogExp2(8633855,.002),renderer.setClearColor(scene.fog.color),!0===eP?(scene.remove(eh),scene.remove(passaro)):(scene.add(eh),scene.add(passaro)),scene.add(ef),scene.add(e$),scene.remove(ex),scene.remove(ev),scene.remove(eb),scene.remove(em),scene.remove(ey),scene.remove(eu),scene.remove(rain),e0.style.display="block",x.style.display="block",g.style.display="none",e0.addEventListener("animationend",function(){this.style.display="none"}),p.play(),u.play()}),document.querySelector(".btnFinal").addEventListener("click",()=>{location.reload()});let ej=`
    varying vec2 vUv;
    uniform float time;
    
        void main() {
        vUv = uv;
        
        vec4 mvPosition = vec4( position, 1.0 );
        #ifdef USE_INSTANCING
            mvPosition = instanceMatrix * mvPosition;
        #endif
        
        float dispPower = 1.0 - cos( uv.y * 3.1416 / 2.0 );
        
        float displacement = sin( mvPosition.z + time * 3.0 ) * ( 0.05 * dispPower );
        mvPosition.z += displacement;

        vec4 modelViewPosition = modelViewMatrix * mvPosition;
        gl_Position = projectionMatrix * modelViewPosition;

        }
    `,eM=`
    varying vec2 vUv;
    
    void main() {
        vec3 baseColor = vec3( 0.61, 1.0, 0.6 );
        float clarity = ( vUv.y * 0.35 ) + 0.00001;
        gl_FragColor = vec4( baseColor * clarity, 1 );
    }
    `;leavesMaterial=new e.ShaderMaterial({vertexShader:ej,fragmentShader:eM,uniforms:{time:{value:0}},side:e.DoubleSide});let eS=new e.Object3D,ek=new e.PlaneGeometry(.01,.2,1);ek.translate(0,.01,0);let e2=new e.InstancedMesh(ek,leavesMaterial,16e4);scene.add(e2);for(let eO=0;eO<16e4;eO++)eS.position.set((Math.random()-.48)*13.5,0,(Math.random()-.58)*11.2),eS.scale.setScalar(.8+.8*Math.random()),eS.rotation.y=Math.random()*Math.PI,eS.updateMatrix(),e2.setMatrixAt(eO,eS.matrix);for(let eB=0;eB<6e4;eB++)eS.position.set((Math.random()-.56)*11.5,0,(Math.random()-2.85)*5.23),eS.scale.setScalar(.8+.8*Math.random()),eS.rotation.y=Math.random()*Math.PI,eS.updateMatrix(),e2.setMatrixAt(eB,eS.matrix);for(let eD=0;eD<1e4;eD++)eS.position.set((Math.random()- -4.6)*1.8,0,(Math.random()-2.8)*5.2),eS.scale.setScalar(.8+.8*Math.random()),eS.rotation.y=Math.random()*Math.PI,eS.updateMatrix(),e2.setMatrixAt(eD,eS.matrix);keysPressed={},document.addEventListener("keydown",e=>{e.shiftKey&&characterControls?characterControls.switchRunToggle():keysPressed[e.key.toLowerCase()]=!0},!1),document.addEventListener("keyup",e=>{keysPressed[e.key.toLowerCase()]=!1},!1),window.addEventListener("resize",function(){camera.aspect=this.window.innerWidth/this.window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(this.window.innerWidth,this.window.innerHeight),labelRenderer.setSize(this.window.innerWidth,this.window.innerHeight)}),window.innerWidth<768&&alert("Coloque em tela cheia e vire a tela do seu celular!!"),animate()}let clock=new e.Clock;function animate(){let e=clock.getDelta();characterControls&&characterControls.update(e,keysPressed),mixer&&mixer.update(e),mixer3&&mixer3.update(e),mixerCozinheiro&&mixerCozinheiro.update(e),mixergalinha&&mixergalinha.update(e),mixerPassaro&&mixerPassaro.update(e),mixerVaca&&mixerVaca.update(e),mixerseta&&mixerseta.update(e),mixerseta1&&mixerseta1.update(e),mixerseta2&&mixerseta2.update(e),orbitControls.update(),!0==andando?(galinha.position.x+=.005,galinha.position.x>=9&&(andando=!1,galinha.rotation.y=-1.5)):(galinha.position.x-=.005,galinha.position.x<=-9&&(andando=!0,galinha.rotation.y=1.5)),!0==andandoPassaro?(passaro.position.x+=.03,passaro.position.x>=100&&(andandoPassaro=!1,passaro.rotation.y=1.5)):(passaro.position.x-=.03,passaro.position.x<=-100&&(andandoPassaro=!0,passaro.rotation.y=-1.5)),!0==decolando&&(aviao.position.y+=.01,aviao.position.x-=.1,aviao.position.x<=8&&(aviao.position.y+=.01,aviao.position.x-=.3),aviao.position.x<=-200&&(decolando=!1)),leavesMaterial.uniforms.time.value=clock.getElapsedTime(),leavesMaterial.uniformsNeedUpdate=!0,labelRenderer.render(scene,camera),renderer.render(scene,camera),requestAnimationFrame(animate)}init();